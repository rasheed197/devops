# EC2 QUICK START

Welcome to AWS console. In this lecture, we are going to see how to launch a virtual machine on AWS cloud, also called as `EC2` instance.

So, whenever you hear the word as `EC2` or `EC2 instances`, or `instances`, in AWS, that means the virtual machines or virtual servers. While we're launching this instance, we are also going to see a lot of features and options in EC2.

First, let's start with the `Region`. So, I'm in North Virginia region, and usually, I stay in United States region because they're cheaper compared to some others.

Some regions are expensive, but do not worry. Anyways, we are going to use most of the things free tier. But I still recommend you stay in any of the United States region. Region has a code, so, I'm in `us-east-1` or I can say `North Virginia`.

Now, let's search for the service `EC2` over here in the search bar. Click on it.

Here, it says Create, manage, and monitor virtual servers in the cloud. Okay. Now, let's click on `Dashboard`.

Okay, so this information over here about the `Resources`, this is not auto refreshed, so you make sure you click on refresh to get the latest status.

Scroll down a little bit,you should see information in the `Service health`, `This service is operating normally`. If there is any issue with the region, you should get the message over here.

So, the region that I have selected is us-east-1, North Virginia, and we know the region is just a label. Region is not the data center, Zones are the physical data centers.

So in the `Zones`, `us-east-1a`, that's one of the zone in the region, us-east-1. So, likewise, you have then 1a, 1b, 1c, 1d. Any region you select, will have minimum two zones.

Also, take a look over here on the left side, you have many sections.

- You have the `Dashboard` that we are seeing right now.

- You have `Instances`.

    Again, instances means the virtual machine on AWS. Our virtual servers on AWS are called EC2 instances. You have `Instances`, you have Instances `Types`, a few other things that we'll see one by one.

- `Images`, Amazon Machine Image.

    Like in Vagrant, we have seen, we have Vagrant boxes like that, in AWS, we have AMI. So, AMIs are the Vagrant boxes of AWS, you can say like that, just for understanding, but just call them as AMI.

- Then, you have `Elastic Block Store`.

    These are the hard-disks, Volumes, Snapshot. We'll see them one by one later.

- `Network & Security`, We have

    `Security Groups`, those are the firewalls. 

    `Elastic IPs`, reserved public IP, you can reserve a public IP and you can attach it to your instance. 
    
    `Key Pairs`, the login keys,

    `Network Interfaces`

- Load Balancing
- Auto Scaling.

We'll see all these things one by one. So let's start launching an instance.

So, you can click over here, `Launch instance`, or you can go to `Instances` and you can click `Launch Instances`.

Okay, so the first one is naming the instance, also called as tags. So, first, will be the name tag, which I'm going to give it as `web01`.

You can add more tags, you click on `Add additional tags`. You get this option. So, name `web01`, that will be the tag on the instances. But you can also tag other things like the `Volumes`, the `Network interfaces` (these are in the `Resource types`).

So, when we create this instance, we'll see that we have volumes and network interfaces on the instances.

Click `Add new tag`.

Let's give another tag. Let's say key `Project`, value `Titan`, the project name. Let's say I'm launching this instance for the Project Titan. And again, I'm going to give the tag to the `Volumes`, to the `Network interfaces`.

Now, like that, you can add more tag. Tags are very good for filtering, if you want to look for all the instances that belongs to Titan Project,  in the search, you can just do `Titan`, and you'll get the list of all the instances. Or the environment tag like you know, dev environment, Q environment, production environment.

So, like key `Env`, and I'm going to say here value `Dev`.

So, the project you're working on will have the naming convention. You can use those naming conventions and give the proper tagging.

Let's come down. Now, selecting the `AMI`, which image would you select to launch your instance? There is no OS installation here. We need to select the ready-made image.

So, first, you have the common options, `Amazon Linux`, which is very similar to CentOS, except you have few changes over here like the download repositories, software repositories will be different, otherwise, most of it is same.

So, like you have CentOS 9, here, you have `Amazon Linux 2023`, you have `Amazon Linux 2 AMI`, that is the equivalent of CentOS 7 or RHEL 7. In this lecture, we'll go with `Amazon Linux 2023 AMI`, but then, we'll also look at other AMIs.

There are also other options too `macOS`, `Ubuntu`, `Windows`, `Red Hat`, `SUSE Linux`, `Debian`, and you can search for more AMIs. So, if you click on `Browse more AMIs`.

So, first section is `Quick Start AMIs` these are the popular AMIs, scroll down, take a look at the AMI, read about them.

And then, there is the `AWS Marketplace AMIs`, where you can search for AMIs with softwares as well. Like if you're looking for a specific software like `OpenVPN`. So, assuming you select this, you launch the instance, you will have the software inbuilt into that.

Also make sure to look at the charges, like for example, this one, the `Wowza Streaming Engine`, it is $85 per month, plus few other things. So, be careful while selecting the AMI.

You have `Splunk Enterprise`, this will come with the Splunk software, and when you launch it later, you can give the license keys and stuff. So, some software comes with the licensing, some you can purchase license and add the information later.

So, if we come to search at the top and let's search for let's say, `centos`. Let's hit Enter and let's see what we get.

So, we have `CentOS Stream 9`, `CentOS Stream 8`, `CentOS 10`. So, most of the CentOS will be free, but some of them will be with support and will be some charges to it. Most of them you see $0 per year, it's free.

Go back to `Quick Start AMIs`, remove the search entry, and make sure to select `Amazon Linux 2023 AMI`, where you see `Free tier eligible`.

That means we can select a free tier instance for this AMI, and the entire instance will be free of charge.

Okay, one final thing, there is `Community AMIs`. Now, these are the AMIs published by people, you can also create your own AMI and publish it. I never use these AMIs, I always trust in building my own AMI instead of using community AMI.

So, I go to `AWS Marketplace AMIs` most of the time, I create the instance, then I create my own custom AMI, and that's the standard actually.

Okay, anyways, let's go back to `Amazon Linux 2023 AMI` in the `Quick Start`, select that, then click `Confirm changes`.

Once again, take a look what AMI you have selected. Look at the `Username`, `ec2-user`. So, that user, we are going to use to log into this instance. This is a Linux-based instance, so, we are going to do SSH, and to do SSH, we need the username and we need password or the login key that we'll see in a moment.

Anyways, let's scroll down and look at the `Instance type`. Instance type basically tells you how much CPU, RAM memory, and few other things like the storage speed and network speed, all those things, all those information, the resource information that you need for the instance.

Now, `t2.micro` or `t3.micro` will be free tier-eligible. So, we are going to go with t2.micro right now. But if you click on dropdown, you should see a huge list, and you should see there, the number of CPUs, the number of memory, and the charges associated with that. If we go with `t2.micro`, there won't any charge whatsoever.

If you want to see more detail about this instance type,just search on the internet, `EC2 instance type`, and you can click on the AWS documentation. You have different sections over here.

- `General purpose`, the `M` series, the most popular one. You should see here how many RAMs, CPU, storage. Like if you go with `m8g.medium`, one CPU, 4 GB memory,network speed, and EBS bandwidth, that's the storage bandwidth, the hard disk.

- You have `Compute Optimized`, where you have the C series, which is for processor or CPU-intensive workloads.

- `Memory Optimized`: like for example, databases, accelerated computing you have.

- You have `Storage Optimized`, 

You have all this, so, based on your requirement, you can select one or you can later change it as well.

Anyways, people most of the time in the beginning of the project goess with `M` series, then based on the load, based on the computing, they changed the instance type.

Let's come back.

Let's make sure we have `t2.micro`. Be careful with this, make sure to select `t2.micro`.

Next is `Key pair (login)`, the login key. How do we log in? So, we can click on `Create new key pair`. As the name says, it's pair, you'll get the public key and private key. The public key will be in the AWS, and private key will be downloaded in your machine.

So, let's give this a name. I'm going to say `webloginkey`. You have two type over here, `.pem`, we are going to go with `.pem`. Then, you have `.ppk` that is used for `PuTTY`. We are going to use Git Bash or Terminal. So, we'll go with `.pem` format.

Click `Create key pair`, it is going to download the private key in my Downloads folder, so, this is the login key, and the public key also called the lock will be in my AWS.

Okay, next is `Network Settings`. So, these information, we'll talk about them in later lectures like the `VPC`, `Subnet`, `Auto-assign public IP`. What I want to show here first is the `security groups` `Firewall`, mandatory for every instance.

So, if you do not create your own security group, this console will create it for you, and you need to mention the rules over there.

So, we are going to click `Edit`, when you go down, you see `Security group name`, we are going to change it to `web-sg`. Okay, in the description, I'm going to give the same `web-sg`, or you can give some meaningful description or message over here.

Here comes the rule, `Inbound Security Group Rule`, the traffic coming towards the instance. So, here, it's selected as type `ssh`. SSH port number is 22.

`Source type`, from where you want to allow port 22, from where the access will be coming. So, I'm going to say My IP, when I click on the `My IP`, it's going to automatically find my public IP, it's my internet public IP. And also, this changes, I have this public IP right now, maybe tomorrow it will be different. If you do not have a static public IP, most of the people don't have static public IP. For the router, they'll have the dynamic one, which changes regularly. So, when it changes, you need to update this rule, and we'll see that once we launch the instance.

For now, just say `ssh` here in the type, source type, `My IP`, it will search your IP and give some `Description`, `Allow 22 from my office`. Any meaningful description you can give for this role.

If you scroll down to `Configure storage`, we can set the storage size and type. So for the type `gp3`, `General Purpose 3`, the most common one right now, and the size, `8` GB. We'll keep it as it is, in later lecture we are going to see this in detail.

Scroll down and you should see here `Advanced details`. Expand this and come till the end where it says `User data`, these are the commands that you want your instance to run when it's launched. In Vagrant, we have seen Vagrant provisioning, same as that.

But first line, now this is a Linux instance,

so we need to give here 

```
#!/bin/bash

dnf install httpd -y
systemctl start httpd
systemctl enable httpd
```

`#!/bin/bash`: it's going to open up a bash shell and execute all the command that we mentioned down there.

Like that, you can give your commands, and when this instance is launched, and ready, it's going to execute all those commands. So, let's keep that and let's click on `Launch instance`.

Now, I have used `dnf` command here because it's Amazon Linux, it's same as CentOS. You can use `yum install` or `dnf install`. So, most of the CentOS command will work on Amazon Linux 2023.

Okay, the instance is launched, we should get an instance ID, e.g  `i-0132daea95ef4cbe4`, every resource in AWS will have an ID. So, If you click on the ID, it's going to open a new tab, where it will search for the instance type and show you.

So, you see the 
`Name tag`: `web01`

`Instance ID`: `i-0132daea95ef4cbe4`

`Instance state`: `Running`

`Instance type`: `t2.micro`

`Status check`: `initializing`

So, AWS will perform two health check on your instance. One is on the hardware, one is on the VM. And this will take time, but you can log in to the instance, and use it even before the health check completes.

`Available zone`: `us-east-1c`

In which zone it was created, we have not selected any zone. If you do not select any zone, AWS will decide for you which zone your instance will be launched in.

You'll get a public DNS name for your instance. This is accessible publicly.

`Public ipv4 DNS`: `ec2-5...amazonaws.com`

This name will resolve to a public IP. Your public IP, 

`Public ipv4 address`: `54.147.215.77`

You have `Elastic IP`, we'll talk about that in later lecture. Elastic IP and public IPv4 are both public IPs, but elastic IP is reserve one. As I said, we'll talk about that in detail later.

Then we have `Security group name`, the login `Key name`, and the `Launch time`.

Pleasego through all these instance details below, there are many information over here. Later, when you want to look for the information, you know where to go.

You have 

`Details` 

`Status and alarms`

`Monitoring`: where you can see the CP utilization and few other things.

`Security`: here you have the security group name or the ID.

`Networking`: here you have the public IP, private IP, and all the networking-related details.

`Storage`

So, go through all this information. We'll go through them one by one in the lectures as we move forward.

At the top we have the `Instance state`, you can stop the instance, reboot, you can terminate.

We also have `Action`, under that we have many options, one option is `Connect`. If you click on `Connect`, it's going to show you methods of connecting. It will show you the `username`, the `public IP`, we also have `SSH client`. If you're using any SSH client like we are going to use, we are going to use Git Bash. It has the SSH inbuilt. So, if you're using any SSH client, you can copy this command, 


```
ssh -i "[PRIVATE/KEY/PATH]" [USERNAME]@[DNS NAME]
```

So, I'm going to copy the ssh command and go to Git Bash, and simply paste this and let's see what happens.

Make sure to give the correct path where the private key was downloaded.

You can also use your public IP instead of the DNS name i.e. 

```
$ ssh -i "[PRIVATE/KEY/PATH]" [USERNAME]@[PUBLIC IP]
```

Now, if I hit Enter, it's going to ask me, do you want to log in? Yes, sure. I accept this, yes. And I am in.

and switch to root user, 

```
$ sudo -i
```

Let me show you a few details, 

```
$ cat /etc/os-release
```

This is Amazon Linux 2023. It's same like Fedora or CentOS.

If you remember, we executed some commands to install and start `httpd` service. Let's see if it's installed or not.

```
$ systemctl status httpd
```

Yeah, it says active (running). Nice. Now, it should have a default webpage also. 

```
$ curl http://127.0.0.1
```

`127.0.0.1` is the local IP or localhost. It shows something, some message, HTML page. It says `It works`.

So, I'm accessing it from internally, it's working. Let me show you the process.

```
$ ps -ef | grep httpd
```

You should see the Apache processes running.

And let's see

```
ss -tunlp | grep [httpd root PID]
```

It says the port 80 is open for this process. So, I can access it locally. I see the process running, I see the port number.

Now, let me access it over the internet. So, if I'm to access it over the internet, I'm going to take its public IP, not private IP. Private IP is internal, public IP is accessible over the internet.

So, I'm going to open the browser,

```
http://[PUBLIC IP]:80
```

Now, I don't even need to give port 80 because HTTP default port is 80. So, I can just remove this :80.

```
http://[PUBLIC IP]
```

I'm just going to hit Enter and let's see what happens. You know, it's just loading. It's not going to show anything. It's going to fail Why?

Everything is running. Still, I'm not able to access it. We see the process, we see the port number.


I'll go back to the `Instances`, go to `Security`, then  `Security group`, click on that. Click on `Edit inbound rules`.

Here you see `SSH` port `22` is allowed from my IP, but HTTP or port 80 is not allowed.

So, I'm going to add the rule

`Type`: `Custom TCP`

`Port range`: `80`

`Source`: `Anywhere-ipv4`

And 


`Type`: `Custom TCP`

`Port range`: `80`

`Source`: `Anywhere-ipv6`

Now click `Save rules`

If you refresh the browser page now, it should work.

Now let's delete the instance, Go to `Instances`, select the instance you want to delete, then click on `Instance state` then `Terminate(delete) instance`