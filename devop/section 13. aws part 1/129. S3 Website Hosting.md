# S3 WEBSITE HOSTING

All right, in this lecture, we are going to host a website on the S3 bucket. And it is a very popular use case. There are many websites, static website, basically, that are running on S3 bucket. And not only that, many application you know, the dynamic website where your user login and stuff like that, post, such kind of application or web application needs publicly available images, documents, videos. You can use S3 for that.

So let's download any template from tooplate.com, once it's downloaded, extract it. So you get a folder, right? And in this folder, all this file will upload in the S3 bucket.

We'll create a new S3 bucket. Actually we are going to create two S3 bucket, which I'll tell you why.

So let's go to S3 service. First, let's create the bucket for hosting our website. We'll give the bucket a unique name `barista123`. Okay, we'll also enable versioning on this, which I will talk about in detail later in the same lecture. So enable versioning and just say `Create bucket`.

Okay, open the bucket and I will say `Upload`, `Add files`. Now, what I can do is I can simply drag and drop all the files also. So I'll select all my website files, I'll drag it and drop it there.

Now, later in the course we will see how to upload it or sync it through command line. But for now we'll just do it through the UI. Just drag and drop all the files and say `Upload`. Okay, this might take some time. Okay, all the files are uploaded.

As I told you, we are going to create one more bucket, and that will be to store the access logs of our website. We'll talk about that again in some time. Just create a bucket with any name e.g `barista908accesslogs`, and simply click `Create bucket`.

Okay, now let's see everything step by step. We have already seen how to make an object public. So first thing will be to make everything public over here. So we know what to do. We'll go to `Permissions`, we'll say `Edit`, and we'll uncheck `Block public access`, and we'll say `Save changes`. Now we go to `Object ownership`, and we will enable the ACLs, and save changes.

Okay, now let's go to all our objects, select all of them, `Action`, and say `Make public using ACL`.

There is a warning that says that it'll be available for everybody on the internet. We're good with that. Make public because that's what we want, right? So all the objects are public, right? But the website is accessed through the main index page, right, the index.html, and that routes to other thing.

Now, S3 gives you a direct option to host the static website. So go to `Properties`, scroll all the way down, and there is an option `Static website hosting`, click on `Edit` and say `Enable`. Okay, to provide the `Index document`, our index document is `index.html`

and we don't have any `Error document`, but we have to give the name. So we'll give that `error.html`, and we'll say `Save changes`. Okay, that's done. 

You get the URL. But when the user access, you should know where the access is coming from, who is accessing it, what browser they're using, regions. All this information gets stored in the access logs. We have seen this in the Apache. Later, also, we have lectures in AWS part two where we'll talk about the access logs.

So in S3 there is an option to store all the access logs. There's the option, same in the `Properties` section, you have the option for `Server access log`. You can say `Edit` and `Enable access log`.

You can specify the bucket or you can just browse it `Browse bucket`. Select your bucket and click `Choose destination`. So it should be in this format, `s3://[bucket name]`

Okay, it gives you the option `Log option key format` also, how do you want to store the logs and which format, year, month, date? We'll keep the default one, and we'll say `Save changes`.

Okay, now it's time to go to static website hosting, copy the URL, put it in the browser, hit enter. Okay, so the website is hosted, you see that, right?

So no more Apache HTTP service, no EC2 instances, no load balancer. So if you want to host a static website, this is pretty easy. You can use this URL and put it in your domain. We'll see in the projects how we use our domain providers, and we know we can have a proper URL, like, you know, barista.somethingsomething.com that points to this URL. So we'll see that later in the project how to enable those CNAME records in your domain.

So come back to S3 `barista908accesslogs`. This is the bucket where access logs will be stored. Now it won't be immediately stored, it's going to take some time.

If you keep accessing your website on the S3 and after some time you will see the access logs appearing over here. I want to show you here one thing, `Permissions`, if you scroll down, `Bucket policy`, this is a JSON policy, which is automatically created when we selected this as the destination bucket for access log. This allows the access logs to be stored in this S3 bucket.

We'll see bucket policy later in the course. Now, come back to our main bucket where we have website hosted. Now, we'll talk about `Versioning`. So we had enable versioning when we are creating the bucket, and you can see an option over here, `Show versions`. If you click on that, you can see here version ID of the files, not the folder, but if you go into the folder, you can see version ID of the files inside that. So we just see single version because we have not overwritten or deleted any file. 

So let's see a few examples how this works. First, turn `Show versions` off, make sure you don't see any version ID of the file.

Let's take example of this file `ABOUT THIS TEMPLATE.txt`. Put a check mark on this. You can delete any file, just put a check mark on it and say `Delete` and come down, you will see an option here, delete, not permanent delete, just delete. If you delete a version of a file, that will be a permanent delete. Okay, just the file deleting, `Delete object`.

Okay, so that file is gone, right? We don't see it, but yeah, when we do `Show versions`, you will see `Delete marker`. The file already exists over there, and there is a delete marker placed on top of it, so file did not go anywhere. You see, file has a size, delete marker has no size. Like that if you overwrite any object, you'll have multiple versions, as many as times you override the file, that many versions you will have.

So when you're deleting object in the S3 bucket that is already versioned, the data is not going anywhere. You are not saving any storage. If your idea was to, you know, delete the data so I need to pay less, then you need to delete the versions of it, not the file.

Okay, now, if we remove this delete marker, select that and say `Delete`. And now you get an option permanently delete over here. So just type `permanently delete` and say delete object. So we deleted the marker, right?

Let's toggle `Show versions` off, you see, the file came back. Like that if you overwrite anything, so let's overwrite `index.html` file. So I just opened a Notepad, I'll say `This is my website on S3`, and I will save it with the name `index.html` on my desktop, and make sure save type as `All files`, otherwise it'll store it with .txt format. Now, we are going to upload one more index.html, `Add file`, and we say `Upload`. Okay, so this is a new file, if you click on `Show versions`, you will see the previous version also. Okay, now we'll access the website once again, let me go to `Properties`, click on the URL. Okay, it says forbidden. I need to make that object (index.html) again public. It's a new object. And, remember, by default, every object that you upload on S3 bucket is private. So it's a new object, so I need to make it public. Select the object say `Action -> Make public using ACL -> Make public`.

Okay, let's refresh the website. Okay, you see that? How can we recover it? Pretty simple. Just turn on `Show versions`, and delete this latest index.html version. So the latest version we have removed. Turn off`Show versions`, and go back to the`Properties` and click the URL again, and we are back online.

So that's how the versioning works. But be careful with this. If you have S3 bucket where you continuously regularly overrides the object, it is going to very quickly increase the size, and you will end up paying more. So you have to enable versioning, if it's really, really required. Otherwise, you need to pay extra because when you override, nothing gets overwritten, it's just the newer version. So data does not go anywhere.

If you really want to remove things, then you need to say `Show versions` and remove all the versions of the file of the object, then only things will be removed.

So that was hosting website, and you've seen some amazing option that S3 bucket provides.

In the next lecture, ee'll see some more advanced option in S3. So wrap this up and join me in the next one.




